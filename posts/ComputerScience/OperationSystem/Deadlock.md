## Deadlock

데드락이란 *교착상태*라고도 불리는 것으로, 멀티프로세스 환경에서 발생한다.

P1, P2 프로세스가 2개씩, 그리고 S1, S2 자원도 2개씩 있다고 하자.<br>
P1과 P2 모두 실행을 하려면 S1, S2를 모두 필요로 하는 상황이다. 그래서 P1은 S1을, P2는 S2를 구한 뒤 실행에 필요한 다른 자원을 구하려고 하고있다.

![deadlock](https://user-images.githubusercontent.com/53729311/111874707-c753d280-89d9-11eb-8ff6-916e5f75e192.jpg)

그런데 필요한 자원을 다른 프로세스가 가지고 있기 때문에 서로 자원을 구할 수 없는 상태이고, 두 프로세스 모두 자원을 얻을 때까지 무한정 대기상태에 빠지게 된다.<br>
이런 상황을 데드락 이라고 한다.

데드락이 발생하기 위해서는 4가지 조건이 필요하다.

<br>

### 데드락 발생조건

1. 상호배제(Mutual exclusion)<br>
자원은 한번에 한 프로세스만 사용한다.

2. 점유대기(Hold and wait)<br>
최소 하나의 자원을 점유하고 있으면서, 다른 프로세스에 할당된 자원을 사용하기 위해 대기하는 프로세스가 있다.

3. 비선점(No preemption)<br>
다른 프로세스에게 할당된 자원을 강제로 뺏을 수 없다.
 
4. 순환대기(Circular wait)<br>
프로세스들이 서로 원을 그리면서 서로의 자원을 요구한다.<br>
예를들어 P1은 P2가 가진 자원을 요구한다. P2는 P3이 가진 자원을 요구한다. ... Pn은 P1을 가진 자원을 요구한다.<br>
이런상황에서 원을 그리며 서로가 가진 자원을 요구하는 것을 말한다.

<br>

### 데드락 처리하기

#### 1. 예방법
데드락이 발생하기 위해서 위의 4가지 조건이 필요하다는 것은 반대로 말하면 하나라도 조건에 맞지 않는다면 데드락은 발생하지 않는다는 뜻이다.

1. 상호배제 부정<br>
자원에 여러 프로세스가 접근할 수 있도록 한다.

2. 삼유대기 부정<br>
프로세스를 실행상태로 만들기 전에 미리 자원을 전부 할당해주고 실행시킨다.

3. 비선점 부정<br>
우선순위를 주어 다른 프로세스가 자원을 요구하면 점유중인 자원을 반납하고, 다시 얻을 때까지 대기한다.

4. 순환대기 부정<br>
자원을 얻을 때 순환상태로 요구하지 못하도록 자원에 번호를 할당하여 자원을 요구할 때 한반향으로만 요구하도록 한다.<br>

#### 2. 회피법
to be continue...
